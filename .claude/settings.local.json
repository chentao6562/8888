{
  "permissions": {
    "allow": [
      "Bash(dir:*)",
      "Bash(ssh-copy-id:*)",
      "Bash(pacman -S:*)",
      "Bash(apt-get install:*)",
      "Bash(ssh -o StrictHostKeyChecking=no root@39.104.13.41 \"mkdir -p ~/.ssh && cat >> ~/.ssh/authorized_keys && chmod 700 ~/.ssh && chmod 600 ~/.ssh/authorized_keys\")",
      "Bash(ssh -i ~/.ssh/id_ed25519_gongsiguanli -o ConnectTimeout=10 root@39.104.13.41 \"echo ''免密登录成功！'' && hostname && uname -a\")",
      "Bash(ssh -i ~/.ssh/id_ed25519_gongsiguanli root@39.104.13.41 \"apt-get update && apt-get install -y curl git nginx mysql-server\")",
      "Bash(ssh:*)",
      "Bash(curl -s http://39.104.13.41:9000/health)",
      "Bash(curl -s http://39.104.13.41/webhook -X GET)",
      "Bash(git init:*)",
      "Bash(git remote add:*)",
      "Bash(git add:*)",
      "Bash(git rm:*)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\n初始化公司管理系统项目\n\n- 添加项目文档：需求文档、业务流程图、数据库设计、原型设计\n- 创建后端项目结构：Express + Prisma + TypeScript\n- 配置 Prisma Schema（包含所有数据表）\n- 添加 CLAUDE.md 项目配置文件\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git branch:*)",
      "Bash(git push:*)",
      "Bash(ls:*)",
      "Bash(git remote set-url:*)",
      "Bash(curl -s http://39.104.13.41:3000/api/health)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\n更新 CLAUDE.md 添加项目目录结构\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfeat: 新增财务管理、自动化、CRM增强等模块的数据库设计\n\n- 新增客户表\\(customers\\)及客户标签系统\n- 新增订单表\\(orders\\)和回款记录表\\(payments\\)\n- 新增支出表\\(expenses\\)和预算表\\(budgets\\)\n- 新增任务管理表\\(tasks\\)和任务评论表\n- 新增内容排期表\\(content_schedules\\)和素材库\\(materials\\)\n- 新增话术模板库\\(script_templates\\)\n- 新增自动化规则表\\(automation_rules\\)和执行日志\n- 新增通知表\\(notifications\\)\n- 更新Prisma schema添加所有新模型及关联关系\n- 更新数据库设计文档添加新表说明和SQL\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(sshpass -p 'c65623518+' ssh -o StrictHostKeyChecking=no root@39.104.13.41 \"ls -la /root/projects/\")",
      "Bash(powershell -Command \"& {plink -batch -pw ''c65623518+'' root@39.104.13.41 ''ls -la /root/projects/''}\")",
      "Bash(powershell -Command \"Write-Host ''plink not found''\")",
      "Bash(where:*)",
      "Bash(powershell -Command \"\n$env:SSH_ASKPASS = ''echo c65623518+''\n$env:DISPLAY = '':0''\nssh -o StrictHostKeyChecking=no -o BatchMode=yes root@39.104.13.41 ''ls -la /root/projects/'' 2>&1\n\")",
      "Bash(python -c \"\nimport paramiko\nimport sys\n\nssh = paramiko.SSHClient\\(\\)\nssh.set_missing_host_key_policy\\(paramiko.AutoAddPolicy\\(\\)\\)\n\ntry:\n    ssh.connect\\(''39.104.13.41'', username=''root'', password=''c65623518+'', timeout=30\\)\n    stdin, stdout, stderr = ssh.exec_command\\(''ls -la /root/projects/''\\)\n    print\\(stdout.read\\(\\).decode\\(\\)\\)\n    print\\(stderr.read\\(\\).decode\\(\\), file=sys.stderr\\)\n    ssh.close\\(\\)\nexcept Exception as e:\n    print\\(f''Error: {e}'', file=sys.stderr\\)\n\")",
      "Bash(python -c \"\nimport paramiko\nimport sys\n\nssh = paramiko.SSHClient\\(\\)\nssh.set_missing_host_key_policy\\(paramiko.AutoAddPolicy\\(\\)\\)\nssh.connect\\(''39.104.13.41'', username=''root'', password=''c65623518+'', timeout=30\\)\n\n# 部署命令\ncmd = ''''''cd /root/projects/8888/server && \\\\ git fetch origin && \\\\ git reset --hard origin/main && \\\\ npm install && \\\\ npx prisma generate && \\\\ npx prisma db push --accept-data-loss && \\\\ npm run build && \\\\ pm2 restart gongsiguanli-api''''''\n\nstdin, stdout, stderr = ssh.exec_command\\(cmd, timeout=180\\)\nprint\\(stdout.read\\(\\).decode\\(\\)\\)\nerr = stderr.read\\(\\).decode\\(\\)\nif err:\n    print\\(''STDERR:'', err, file=sys.stderr\\)\nssh.close\\(\\)\n\")",
      "Bash(python -c \"\nimport paramiko\nimport sys\n\nssh = paramiko.SSHClient\\(\\)\nssh.set_missing_host_key_policy\\(paramiko.AutoAddPolicy\\(\\)\\)\nssh.connect\\(''39.104.13.41'', username=''root'', password=''c65623518+'', timeout=30\\)\n\ncmd = ''''''cd /root/projects/8888/server && git fetch origin && git reset --hard origin/main && npm install && npx prisma generate && npx prisma db push --accept-data-loss && npm run build && pm2 restart gongsiguanli-api''''''\n\nstdin, stdout, stderr = ssh.exec_command\\(cmd, timeout=180\\)\nout = stdout.read\\(\\).decode\\(''utf-8'', errors=''replace''\\)\nerr = stderr.read\\(\\).decode\\(''utf-8'', errors=''replace''\\)\nprint\\(out\\)\nif err:\n    print\\(''STDERR:'', err\\)\nssh.close\\(\\)\n\")",
      "Bash(chcp:*)",
      "Bash(python -c \"\nimport paramiko\nimport sys\nimport io\nsys.stdout = io.TextIOWrapper\\(sys.stdout.buffer, encoding=''utf-8''\\)\nsys.stderr = io.TextIOWrapper\\(sys.stderr.buffer, encoding=''utf-8''\\)\n\nssh = paramiko.SSHClient\\(\\)\nssh.set_missing_host_key_policy\\(paramiko.AutoAddPolicy\\(\\)\\)\nssh.connect\\(''39.104.13.41'', username=''root'', password=''c65623518+'', timeout=30\\)\n\ncmd = ''''''cd /root/projects/8888/server && git fetch origin && git reset --hard origin/main && npm install && npx prisma generate && npx prisma db push --accept-data-loss && npm run build && pm2 restart gongsiguanli-api''''''\n\nstdin, stdout, stderr = ssh.exec_command\\(cmd, timeout=180\\)\nout = stdout.read\\(\\).decode\\(''utf-8'', errors=''replace''\\)\nerr = stderr.read\\(\\).decode\\(''utf-8'', errors=''replace''\\)\nprint\\(out\\)\nif err:\n    print\\(''STDERR:'', err\\)\nssh.close\\(\\)\n\")",
      "Bash(PYTHONIOENCODING=utf-8 python3 -c \"\nimport paramiko\n\nssh = paramiko.SSHClient\\(\\)\nssh.set_missing_host_key_policy\\(paramiko.AutoAddPolicy\\(\\)\\)\nssh.connect\\(''39.104.13.41'', username=''root'', password=''c65623518+'', timeout=30\\)\n\ncmd = ''cd /root/projects/8888/server && git fetch origin && git reset --hard origin/main && npm install && npx prisma generate && npx prisma db push --accept-data-loss && npm run build && pm2 restart gongsiguanli-api''\n\nstdin, stdout, stderr = ssh.exec_command\\(cmd, timeout=180\\)\nout = stdout.read\\(\\).decode\\(''utf-8'', errors=''ignore''\\)\nerr = stderr.read\\(\\).decode\\(''utf-8'', errors=''ignore''\\)\n\n# Write to file to avoid encoding issues\nwith open\\(''/tmp/deploy_out.txt'', ''w'', encoding=''utf-8''\\) as f:\n    f.write\\(out\\)\n    if err:\n        f.write\\(''\\\\nSTDERR:\\\\n'' + err\\)\nssh.close\\(\\)\nprint\\(''Done. Check /tmp/deploy_out.txt''\\)\n\")",
      "Bash(python -u -c \"\nimport paramiko\nimport os\n\nssh = paramiko.SSHClient\\(\\)\nssh.set_missing_host_key_policy\\(paramiko.AutoAddPolicy\\(\\)\\)\nssh.connect\\(''39.104.13.41'', username=''root'', password=''c65623518+'', timeout=30\\)\n\ncmd = ''cd /root/projects/8888/server && git fetch origin && git reset --hard origin/main && npm install 2>&1 && npx prisma generate 2>&1 && npx prisma db push --accept-data-loss 2>&1 && npm run build 2>&1 && pm2 restart gongsiguanli-api 2>&1''\n\nstdin, stdout, stderr = ssh.exec_command\\(cmd, timeout=180\\)\nresult = stdout.read\\(\\)\n\n# Save to temp file\ntemp_file = os.path.join\\(os.environ.get\\(''TEMP'', ''/tmp''\\), ''deploy_result.txt''\\)\nwith open\\(temp_file, ''wb''\\) as f:\n    f.write\\(result\\)\n\nssh.close\\(\\)\nprint\\(''Output saved to:'', temp_file\\)\n\")",
      "Bash(python -u -c \"\nimport paramiko\n\nssh = paramiko.SSHClient\\(\\)\nssh.set_missing_host_key_policy\\(paramiko.AutoAddPolicy\\(\\)\\)\nssh.connect\\(''39.104.13.41'', username=''root'', password=''c65623518+'', timeout=30\\)\n\nstdin, stdout, stderr = ssh.exec_command\\(''curl -s http://localhost:3000/api/health'', timeout=30\\)\nresult = stdout.read\\(\\).decode\\(''utf-8'', errors=''ignore''\\)\nprint\\(result\\)\nssh.close\\(\\)\n\")",
      "Bash(npm run build:*)",
      "Bash(npx tsc)",
      "Bash(npm install:*)",
      "Bash(git commit:*)",
      "Bash(curl:*)",
      "Bash(python -c \"\nimport paramiko\nimport sys\n\n# SSH 连接参数\nhostname = ''39.104.13.41''\nusername = ''root''\npassword = ''c65623518+''\n\n# 创建 SSH 客户端\nclient = paramiko.SSHClient\\(\\)\nclient.set_missing_host_key_policy\\(paramiko.AutoAddPolicy\\(\\)\\)\n\ntry:\n    # 连接服务器\n    print\\(''正在连接服务器 {}...''.format\\(hostname\\)\\)\n    client.connect\\(hostname, port=22, username=username, password=password, timeout=30\\)\n    print\\(''连接成功！\\\\n''\\)\n    \n    # 执行命令\n    command = ''cd /root/projects/8888/server && npm run prisma:seed''\n    print\\(''执行命令: {}\\\\n''.format\\(command\\)\\)\n    print\\(''='' * 60\\)\n    \n    stdin, stdout, stderr = client.exec_command\\(command, timeout=120\\)\n    \n    # 获取输出\n    stdout_text = stdout.read\\(\\).decode\\(''utf-8''\\)\n    stderr_text = stderr.read\\(\\).decode\\(''utf-8''\\)\n    exit_code = stdout.channel.recv_exit_status\\(\\)\n    \n    if stdout_text:\n        print\\(''标准输出:''\\)\n        print\\(stdout_text\\)\n    \n    if stderr_text:\n        print\\(''标准错误:''\\)\n        print\\(stderr_text\\)\n    \n    print\\(''='' * 60\\)\n    print\\(''命令退出码: {}''.format\\(exit_code\\)\\)\n    \nexcept Exception as e:\n    print\\(''错误: {}''.format\\(str\\(e\\)\\)\\)\n    sys.exit\\(1\\)\nfinally:\n    client.close\\(\\)\n    print\\(''\\\\n连接已关闭''\\)\n\")",
      "Bash(python -c \"\nimport paramiko\nimport sys\nimport io\n\nsys.stdout = io.TextIOWrapper\\(sys.stdout.buffer, encoding=''utf-8'', errors=''replace''\\)\nsys.stderr = io.TextIOWrapper\\(sys.stderr.buffer, encoding=''utf-8'', errors=''replace''\\)\n\n# SSH 连接参数\nhostname = ''39.104.13.41''\nusername = ''root''\npassword = ''c65623518+''\n\n# 创建 SSH 客户端\nclient = paramiko.SSHClient\\(\\)\nclient.set_missing_host_key_policy\\(paramiko.AutoAddPolicy\\(\\)\\)\n\ntry:\n    print\\(''Connecting to server {}...''.format\\(hostname\\)\\)\n    client.connect\\(hostname, port=22, username=username, password=password, timeout=30\\)\n    print\\(''Connected successfully!''\\)\n    print\\(''''\\)\n    \n    # 执行命令\n    command = ''cd /root/projects/8888/server && npm run prisma:seed''\n    print\\(''Executing: {}''.format\\(command\\)\\)\n    print\\(''='' * 60\\)\n    \n    stdin, stdout, stderr = client.exec_command\\(command, timeout=120\\)\n    \n    # 获取输出\n    stdout_text = stdout.read\\(\\).decode\\(''utf-8'', errors=''replace''\\)\n    stderr_text = stderr.read\\(\\).decode\\(''utf-8'', errors=''replace''\\)\n    exit_code = stdout.channel.recv_exit_status\\(\\)\n    \n    if stdout_text:\n        print\\(''STDOUT:''\\)\n        print\\(stdout_text\\)\n    \n    if stderr_text:\n        print\\(''STDERR:''\\)\n        print\\(stderr_text\\)\n    \n    print\\(''='' * 60\\)\n    print\\(''Exit code: {}''.format\\(exit_code\\)\\)\n    \nexcept Exception as e:\n    print\\(''Error: {}''.format\\(str\\(e\\)\\)\\)\n    sys.exit\\(1\\)\nfinally:\n    client.close\\(\\)\n    print\\(''Connection closed''\\)\n\")",
      "Bash(python -c \"\nimport paramiko\n\nhostname = ''39.104.13.41''\nusername = ''root''\npassword = ''c65623518+''\n\nclient = paramiko.SSHClient\\(\\)\nclient.set_missing_host_key_policy\\(paramiko.AutoAddPolicy\\(\\)\\)\n\ntry:\n    print\\(''Connecting to server '' + hostname + ''...''\\)\n    client.connect\\(hostname, port=22, username=username, password=password, timeout=30\\)\n    print\\(''Connected successfully!''\\)\n    print\\(''''\\)\n    \n    command = ''cd /root/projects/8888/server && npm run prisma:seed''\n    print\\(''Executing: '' + command\\)\n    print\\(''='' * 60\\)\n    \n    stdin, stdout, stderr = client.exec_command\\(command, timeout=120\\)\n    \n    stdout_text = stdout.read\\(\\).decode\\(''utf-8'', errors=''replace''\\)\n    stderr_text = stderr.read\\(\\).decode\\(''utf-8'', errors=''replace''\\)\n    exit_code = stdout.channel.recv_exit_status\\(\\)\n    \n    if stdout_text:\n        print\\(''STDOUT:''\\)\n        print\\(stdout_text\\)\n    \n    if stderr_text:\n        print\\(''STDERR:''\\)\n        print\\(stderr_text\\)\n    \n    print\\(''='' * 60\\)\n    print\\(''Exit code: '' + str\\(exit_code\\)\\)\n    \nexcept Exception as e:\n    print\\(''Error: '' + str\\(e\\)\\)\nfinally:\n    client.close\\(\\)\n    print\\(''Connection closed''\\)\n\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsInVzZXJuYW1lIjoiYWRtaW4iLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3Njc5NzY0MDksImV4cCI6MTc2ODU4MTIwOX0.tIdrnI9mtA4GEWo6uycL--Sk7BwOEn5rLeu447f5k_8\")"
    ]
  }
}
